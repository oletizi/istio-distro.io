<!doctype html><html lang=en-us><head><meta charset=utf-8><title itemprop=name>GCP CA Integration | GetIstio by Tetrate | Simple, safe enterprise-grade Istio distro</title><meta name=twitter:title content="GCP CA Integration | GetIstio by Tetrate | Simple, safe enterprise-grade Istio distro"><meta itemprop=name content="GCP CA Integration | GetIstio by Tetrate | Simple, safe enterprise-grade Istio distro"><meta name=application-name content="GCP CA Integration | GetIstio by Tetrate | Simple, safe enterprise-grade Istio distro"><meta property="og:site_name" content="Tetrate Istio Distro"><meta name=description content="Tetrate Istio Distro project provides a simple, safe, enterprise-grade Istio distro."><meta itemprop=description content="Tetrate Istio Distro project provides a simple, safe, enterprise-grade Istio distro."><meta name=twitter:description content="Tetrate Istio Distro project provides a simple, safe, enterprise-grade Istio distro."><meta property="og:locale" content="en"><meta name=language content="En"><link rel=alternate hreflang=en href=/istio-ca-certs-integrations/gcp-cas-integration/><link rel=alternate hreflang=zh href=/zh/istio-ca-certs-integrations/gcp-cas-integration/><meta property="og:updated_time" content="2021-01-25T13:00:00+0700"><link rel=sitemap type=application/xml title=Sitemap href=/sitemap.xml><link href=/istio-ca-certs-integrations/gcp-cas-integration/index.xml rel=alternate type=application/rss+xml title="Tetrate Istio Distro | Simple, safe enterprise-grade Istio"><link href=/istio-ca-certs-integrations/gcp-cas-integration/index.xml rel=feed type=application/rss+xml title="Tetrate Istio Distro | Simple, safe enterprise-grade Istio"><meta property="og:type" content="website"><meta name=author content="Tetrate"><script defer type=application/ld+json>{"@context":"http://schema.org","@type":"WebSite","url":"https:\/\/istio.tetratelabs.io\/istio-ca-certs-integrations\/gcp-cas-integration\/","sameAs":["","https:\/\/github.com\/tetratelabs\/getmesh"],"name":"Tetrate Istio Distro | Simple, safe enterprise-grade Istio","logo":"https://getistio.io/images/getistio-by-tetrate-logo.png"}</script><meta name=robots content="index,follow"><meta name=googlebot content="index,follow"><meta name=twitter:site content="@tetrateio"><meta name=twitter:creator content="@tetrateio"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=5"><meta name=generator content="Hugo 0.85.0"><script async src="https://www.googletagmanager.com/gtag/js?id=G-P3J9XNBME4"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-P3J9XNBME4')</script><link rel=preload href=/plugins/themify-icons/themify-icons.css as=style onload="this.onload=null,this.rel='stylesheet'"><noscript><link rel=stylesheet href=/plugins/themify-icons/themify-icons.css></noscript><link rel=preload href=/plugins/search/auto-complete.css as=style onload="this.onload=null,this.rel='stylesheet'"><noscript><link rel=stylesheet href=/plugins/search/auto-complete.css></noscript><link rel=preload href=/plugins/featherlight/featherlight.min.css as=style onload="this.onload=null,this.rel='stylesheet'"><noscript><link rel=stylesheet href=/plugins/featherlight/featherlight.min.css></noscript><link rel=preload href=/css/bootstrap/bootstrap.min.css as=style onload="this.onload=null,this.rel='stylesheet'"><noscript><link rel=stylesheet href=/css/bootstrap/bootstrap.min.css></noscript><link rel=preload href=/scss/style.css as=style onload="this.onload=null,this.rel='stylesheet'"><noscript><link rel=stylesheet href=/scss/style.css></noscript><link rel="shortcut icon" href=/images/getistio-favicon.png type=image/x-icon><link rel=icon href=/images/getistio-favicon.png type=image/x-icon><meta property="og:title" content="GCP CA Integration"><meta property="og:description" content="GCP CA Integration"><meta property="og:type" content="website"><meta property="og:url" content="https://istio.tetratelabs.io/istio-ca-certs-integrations/gcp-cas-integration/"><meta property="og:image" content="https://istio.tetratelabs.io/images/twitter-card-new.png"><script async defer src=/js/turbolinks.min.js></script></head><body><header class="sticky-top navigation"><div class=my-container><nav class="navbar navbar-expand-lg navbar-light bg-transparent"><div class=navbar-brand-container><a class=navbar-brand href=/><img class="img-fluid logo-width" src=/images/tetrate-istio-distro-logo.png alt="Tetrate Istio Distro | Simple, safe enterprise-grade Istio"></a>
<a class=github-button href=https://github.com/tetratelabs/getistio data-icon=octicon-star aria-label="Star tetratelabs/getmesh on GitHub">Star</a></div><button aria-label=Menu class="navbar-toggler border-0" type=button data-toggle=collapse data-target=#navigation>
<i class="ti-menu h4 text-white"></i></button><div class="collapse navbar-collapse text-center" id=navigation><ul class="navbar-nav mx-auto align-items-center"><li class=nav-item><a class=nav-link href=/getmesh-cli/>Docs</a></li><li class=nav-item><a class=nav-link href=/blog/>Blog</a></li><li class=nav-item><a class=nav-link href=/community-events/>Community</a></li><li class=nav-item><a class=nav-link href=https://academy.tetrate.io target=_blank>Training</a></li><li class=nav-item><a class=nav-link href=https://func-e.io/ target=_blank>func-e</a></li><li class=nav-item><a class=nav-link href=https://www.istio.io/ target=_blank>Istio.io</a></li><li class=nav-link><select class=nav-item id=select-language onchange="location=this.value"><option id=en value=/istio-ca-certs-integrations/gcp-cas-integration/ selected>En</option><option id=zh value=/zh/istio-ca-certs-integrations/gcp-cas-integration/>中文</option></select></li></ul><div class="d-lg-none d-block"><a href=/download class="btn btn-sm btn-primary ml-lg-4">download</a></div></div><div class="d-lg-flex d-none"><a href=/download class="btn btn-sm btn-primary ml-lg-4">Download</a></div></nav></div></header><section class=pt-5><div class="container d-block d-sm-block d-lg-none"><div class="row justify-content-center mb-4"><div><button onclick=dropdownFunction() class="btn btn-primary dropdown-toggle nav-dropdown">Browse Docs
<span class=caret></span></button><ul id=mobileDropdownMenu class=dropdown-content><li data-nav-id=/introduction/ title=Introduction class="sidelist my-2"><a href=/introduction/>Introduction</a></li><li data-nav-id=/quickstart/ title="TID Quickstart" class="sidelist my-2"><a href=/quickstart/>TID Quickstart</a></li><li data-nav-id=/mgmt-tasks/ title="Common Management Tasks" class="sidelist my-2"><a href=/mgmt-tasks/>Common Management Tasks</a></li><li data-nav-id=/getmesh-cli/ title="GetMesh Documentation" class="sidelist my-2"><a href=/getmesh-cli/>GetMesh Documentation</a></li><li data-nav-id=/istio-in-practice/ title="Istio in Practice" class="sidelist my-2"><a href=/istio-in-practice/>Istio in Practice</a></li><li data-nav-id=/istio-ca-certs-integrations/ title="Istio CA Certs Integration" class="sidelist parent my-2"><a href=/istio-ca-certs-integrations/>Istio CA Certs Integration</a></li><li data-nav-id=/istio-cheatsheet/ title="Istio Hints and Tips" class="sidelist my-2"><a href=/istio-cheatsheet/>Istio Hints and Tips</a></li><li data-nav-id=/helm/ title="Helm Chart Deployment" class="sidelist my-2"><a href=/helm/>Helm Chart Deployment</a></li><li data-nav-id=/download/ title=Downloads class="sidelist my-2"><a href=/download/>Downloads</a></li><li data-nav-id=/faq/ title=FAQs class="sidelist my-2"><a href=/faq/>FAQs</a></li><li data-nav-id=/community/ title=Community class="sidelist my-2"><a href=/community/>Community</a></li><li data-nav-id=/fips-request/ title="FIPS Download Request" class="sidelist my-2"><a href=/fips-request/>FIPS Download Request</a></li></ul></div></div></div><div class="container shadow section-sm rounded docs-content"><div class=row><div class="col-lg-3 d-none d-md-none d-lg-block"><ul class=sidenav><li data-nav-id=/introduction/ title=Introduction class=sidelist><a href=/introduction/>Introduction</a><ul><li data-nav-id=/introduction/intro/ title class=sidelist><a href=/introduction/intro/></a></ul></li><li data-nav-id=/quickstart/ title="TID Quickstart" class=sidelist><a href=/quickstart/>TID Quickstart</a><ul><li data-nav-id=/quickstart/start/ title class=sidelist><a href=/quickstart/start/></a></ul></li><li data-nav-id=/mgmt-tasks/ title="Common Management Tasks" class=sidelist><a href=/mgmt-tasks/>Common Management Tasks</a><ul><li data-nav-id=/mgmt-tasks/install-istio-updates/ title="Install Istio Updates" class=sidelist><a href=/mgmt-tasks/install-istio-updates/>Install Istio Updates</a><li data-nav-id=/mgmt-tasks/install-istio-and-manage-multiple-istioctl/ title="Manage multiple istioctl" class=sidelist><a href=/mgmt-tasks/install-istio-and-manage-multiple-istioctl/>Manage multiple istioctl</a><li data-nav-id=/mgmt-tasks/config-validation/ title="Config Validation" class=sidelist><a href=/mgmt-tasks/config-validation/>Config Validation</a></ul></li><li data-nav-id=/getmesh-cli/ title="GetMesh Documentation" class=sidelist><a href=/getmesh-cli/>GetMesh Documentation</a><ul><li data-nav-id=/getmesh-cli/install/ title="Install GetMesh and Istio" class=sidelist><a href=/getmesh-cli/install/>Install GetMesh and Istio</a><ul><li data-nav-id=/getmesh-cli/install/install-istio/ title="Install Istio" class=sidelist><a href=/getmesh-cli/install/install-istio/>Install Istio</a><ul><li data-nav-id=/getmesh-cli/install/install-istio/prepare-eks-cluster/ title="Prepare AWS EKS cluster" class=sidelist><a href=/getmesh-cli/install/install-istio/prepare-eks-cluster/>Prepare AWS EKS cluster</a><li data-nav-id=/getmesh-cli/install/install-istio/aks-tid-deployment/ title="Install Istio on Azure AKS" class=sidelist><a href=/getmesh-cli/install/install-istio/aks-tid-deployment/>Install Istio on Azure AKS</a><li data-nav-id=/getmesh-cli/install/install-istio/eks-addon/ title="Install Istio in EKS with add-on" class=sidelist><a href=/getmesh-cli/install/install-istio/eks-addon/>Install Istio in EKS with add-on</a><li data-nav-id=/getmesh-cli/install/install-istio/deploy-gateway/ title="Deploy Istio Gateway in EKS" class=sidelist><a href=/getmesh-cli/install/install-istio/deploy-gateway/>Deploy Istio Gateway in EKS</a></ul></li><li data-nav-id=/getmesh-cli/install/install-and-update/ title="GetMesh installation and update" class=sidelist><a href=/getmesh-cli/install/install-and-update/>GetMesh installation and update</a><li data-nav-id=/getmesh-cli/install/post-install/ title="Once you've installed Istio" class=sidelist><a href=/getmesh-cli/install/post-install/>Once you've installed Istio</a></ul></li><li data-nav-id=/getmesh-cli/reference/ title=Reference class=sidelist><a href=/getmesh-cli/reference/>Reference</a><ul><li data-nav-id=/getmesh-cli/reference/getmesh/ title=GetMesh class=sidelist><a href=/getmesh-cli/reference/getmesh/>GetMesh</a><li data-nav-id=/getmesh-cli/reference/getmesh_check-upgrade/ title="getmesh check-upgrade" class=sidelist><a href=/getmesh-cli/reference/getmesh_check-upgrade/>getmesh check-upgrade</a><li data-nav-id=/getmesh-cli/reference/getmesh_config-validate/ title="getmesh config-validate" class=sidelist><a href=/getmesh-cli/reference/getmesh_config-validate/>getmesh config-validate</a><li data-nav-id=/getmesh-cli/reference/getmesh_default-hub/ title="getmesh default-hub" class=sidelist><a href=/getmesh-cli/reference/getmesh_default-hub/>getmesh default-hub</a><li data-nav-id=/getmesh-cli/reference/getmesh_fetch/ title="getmesh fetch" class=sidelist><a href=/getmesh-cli/reference/getmesh_fetch/>getmesh fetch</a><li data-nav-id=/getmesh-cli/reference/getmesh_gen-ca/ title="getmesh gen-ca" class=sidelist><a href=/getmesh-cli/reference/getmesh_gen-ca/>getmesh gen-ca</a><li data-nav-id=/getmesh-cli/reference/getmesh_help/ title="getmesh help" class=sidelist><a href=/getmesh-cli/reference/getmesh_help/>getmesh help</a><li data-nav-id=/getmesh-cli/reference/getmesh_istioctl/ title="getmesh istioctl" class=sidelist><a href=/getmesh-cli/reference/getmesh_istioctl/>getmesh istioctl</a><li data-nav-id=/getmesh-cli/reference/getmesh_list/ title="getmesh list" class=sidelist><a href=/getmesh-cli/reference/getmesh_list/>getmesh list</a><li data-nav-id=/getmesh-cli/reference/getmesh_prune/ title="getmesh prune" class=sidelist><a href=/getmesh-cli/reference/getmesh_prune/>getmesh prune</a><li data-nav-id=/getmesh-cli/reference/getmesh_show/ title="getmesh show" class=sidelist><a href=/getmesh-cli/reference/getmesh_show/>getmesh show</a><li data-nav-id=/getmesh-cli/reference/getmesh_switch/ title="getmesh switch" class=sidelist><a href=/getmesh-cli/reference/getmesh_switch/>getmesh switch</a><li data-nav-id=/getmesh-cli/reference/getmesh_version/ title="getmesh version" class=sidelist><a href=/getmesh-cli/reference/getmesh_version/>getmesh version</a></ul></li></ul></li><li data-nav-id=/istio-in-practice/ title="Istio in Practice" class=sidelist><a href=/istio-in-practice/>Istio in Practice</a><ul><li data-nav-id=/istio-in-practice/prerequisites/ title=Prerequisites class=sidelist><a href=/istio-in-practice/prerequisites/>Prerequisites</a><li data-nav-id=/istio-in-practice/zero-downtime-releases/ title="How to do Zero-Downtime Releases" class=sidelist><a href=/istio-in-practice/zero-downtime-releases/>How to do Zero-Downtime Releases</a><li data-nav-id=/istio-in-practice/traffic-mirroring/ title="How to use Traffic Mirroring" class=sidelist><a href=/istio-in-practice/traffic-mirroring/>How to use Traffic Mirroring</a><li data-nav-id=/istio-in-practice/sticky-sessions/ title="How to use Sticky Sessions" class=sidelist><a href=/istio-in-practice/sticky-sessions/>How to use Sticky Sessions</a><li data-nav-id=/istio-in-practice/setting-up-ssl-certs/ title="How to set up SSL Certificates" class=sidelist><a href=/istio-in-practice/setting-up-ssl-certs/>How to set up SSL Certificates</a><li data-nav-id=/istio-in-practice/multiple-ingress-gateways/ title="How to Deploy Multiple Istio Ingress Gateways" class=sidelist><a href=/istio-in-practice/multiple-ingress-gateways/>How to Deploy Multiple Istio Ingress Gateways</a><li data-nav-id=/istio-in-practice/aws-cloudmap-integration/ title="Integrate AWS Cloud Map with Istio" class=sidelist><a href=/istio-in-practice/aws-cloudmap-integration/>Integrate AWS Cloud Map with Istio</a><li data-nav-id=/istio-in-practice/install-skywalking/ title="Integration with Apache SkyWalking" class=sidelist><a href=/istio-in-practice/install-skywalking/>Integration with Apache SkyWalking</a></ul></li><li data-nav-id=/istio-ca-certs-integrations/ title="Istio CA Certs Integration" class="sidelist parent"><a href=/istio-ca-certs-integrations/>Istio CA Certs Integration</a><ul><li data-nav-id=/istio-ca-certs-integrations/acmpca-integration/ title="AWS Private CA Integration" class=sidelist><a href=/istio-ca-certs-integrations/acmpca-integration/>AWS Private CA Integration</a><li data-nav-id=/istio-ca-certs-integrations/gcp-cas-integration/ title="GCP CA Integration" class="sidelist parent active"><a href=/istio-ca-certs-integrations/gcp-cas-integration/>GCP CA Integration</a><li data-nav-id=/istio-ca-certs-integrations/cert-manager-integration/ title="cert-manager CA Integration" class=sidelist><a href=/istio-ca-certs-integrations/cert-manager-integration/>cert-manager CA Integration</a></ul></li><li data-nav-id=/istio-cheatsheet/ title="Istio Hints and Tips" class=sidelist><a href=/istio-cheatsheet/>Istio Hints and Tips</a><ul><li data-nav-id=/istio-cheatsheet/cheatsheet/ title class=sidelist><a href=/istio-cheatsheet/cheatsheet/></a></ul></li><li data-nav-id=/helm/ title="Helm Chart Deployment" class=sidelist><a href=/helm/>Helm Chart Deployment</a><ul><li data-nav-id=/helm/charts/ title class=sidelist><a href=/helm/charts/></a></ul></li><li data-nav-id=/download/ title=Downloads class=sidelist><a href=/download/>Downloads</a><ul><li data-nav-id=/download/downloads/ title class=sidelist><a href=/download/downloads/></a></ul></li><li data-nav-id=/faq/ title=FAQs class=sidelist><a href=/faq/>FAQs</a><ul><li data-nav-id=/faq/questions/ title class=sidelist><a href=/faq/questions/></a></ul></li><li data-nav-id=/community/ title=Community class=sidelist><a href=/community/>Community</a><ul><li data-nav-id=/community/event/getistio-inaugural/ title="What is GetIstio - Inaugural Community Meetup" class=sidelist><a href=/community/event/getistio-inaugural/>What is GetIstio - Inaugural Community Meetup</a><li data-nav-id=/community/event/istiocon-2021/ title="IstioCon 2021" class=sidelist><a href=/community/event/istiocon-2021/>IstioCon 2021</a><li data-nav-id=/community/event/getenvoy-deep-dive/ title="Effortless Envoy and WASM with GetEnvoy" class=sidelist><a href=/community/event/getenvoy-deep-dive/>Effortless Envoy and WASM with GetEnvoy</a><li data-nav-id=/community/event/getistio-deep-dive/ title="Istio the Easy Way with GetIstio" class=sidelist><a href=/community/event/getistio-deep-dive/>Istio the Easy Way with GetIstio</a><li data-nav-id=/community/event/tid-episode-003/ title="SSL Certificates in Istio Ingress Gateway" class=sidelist><a href=/community/event/tid-episode-003/>SSL Certificates in Istio Ingress Gateway</a><li data-nav-id=/community/event/tid-episode-004/ title="Deploying multiple Istio ingress gateways" class=sidelist><a href=/community/event/tid-episode-004/>Deploying multiple Istio ingress gateways</a><li data-nav-id=/community/event/tid-episode-006/ title="Istio Big Talk Episode 4" class=sidelist><a href=/community/event/tid-episode-006/>Istio Big Talk Episode 4</a><li data-nav-id=/community/event/tid-episode-005/ title="Security in Istio" class=sidelist><a href=/community/event/tid-episode-005/>Security in Istio</a><li data-nav-id=/community/event/tid-episode-007/ title="Istio Big Talk Episode 5" class=sidelist><a href=/community/event/tid-episode-007/>Istio Big Talk Episode 5</a><li data-nav-id=/community/event/tid-episode-008/ title="Istio Weekly Episode 6: Envoy Fundamentals" class=sidelist><a href=/community/event/tid-episode-008/>Istio Weekly Episode 6: Envoy Fundamentals</a><li data-nav-id=/community/event/tid-episode-009/ title="Episode 07: Developing Envoy Wasm Extensions" class=sidelist><a href=/community/event/tid-episode-009/>Episode 07: Developing Envoy Wasm Extensions</a><li data-nav-id=/community/event/tid-episode-010/ title="Istio in the enterprise: Solving security and scale challenges for microservices in Kubernetes" class=sidelist><a href=/community/event/tid-episode-010/>Istio in the enterprise: Solving security and scale challenges for microservices in Kubernetes</a><li data-nav-id=/community/event/tid-episode-011/ title="Episode 08: External CA with Istio" class=sidelist><a href=/community/event/tid-episode-011/>Episode 08: External CA with Istio</a><li data-nav-id=/community/event/tid-episode-012/ title="Episode 09: Customizing Istio metrics" class=sidelist><a href=/community/event/tid-episode-012/>Episode 09: Customizing Istio metrics</a><li data-nav-id=/community/event/tid-episode-013/ title class=sidelist><a href=/community/event/tid-episode-013/></a><li data-nav-id=/community/event/tid-episode-016/ title="Access Control for Microservices" class=sidelist><a href=/community/event/tid-episode-016/>Access Control for Microservices</a><li data-nav-id=/community/building-and-testing/ title="Building and Testing" class=sidelist><a href=/community/building-and-testing/>Building and Testing</a><li data-nav-id=/community/contributing/ title="Contributing to GetMesh" class=sidelist><a href=/community/contributing/>Contributing to GetMesh</a><li data-nav-id=/community/event/tid-episode-014/ title="Episode 11: Enterprise service mesh and why you need it" class=sidelist><a href=/community/event/tid-episode-014/>Episode 11: Enterprise service mesh and why you need it</a><li data-nav-id=/community/event/tid-episode-015/ title="Episode 12: How I started contributing to Istio and Envoy" class=sidelist><a href=/community/event/tid-episode-015/>Episode 12: How I started contributing to Istio and Envoy</a><li data-nav-id=/community/event/tid-episode-018/ title="Episode 15: Setting up Istio with external control plane" class=sidelist><a href=/community/event/tid-episode-018/>Episode 15: Setting up Istio with external control plane</a><li data-nav-id=/community/event/tid-episode-017/ title="Istio's new Wasm-based extension mechanism and ecosystem" class=sidelist><a href=/community/event/tid-episode-017/>Istio's new Wasm-based extension mechanism and ecosystem</a></ul></li><li data-nav-id=/fips-request/ title="FIPS Download Request" class=sidelist><a href=/fips-request/>FIPS Download Request</a><ul><li data-nav-id=/fips-request/fips/ title class=sidelist><a href=/fips-request/fips/></a></ul></li></ul></div><div class=col-lg-9><div class="px-lg-5 px-4"><h1 class="mb-4 font-weight-medium">GCP CA Integration</h1><div class=content><p>Instead of using a self-signed root certificate, here we get an intermediary Istio certificate authority (CA) from GCP CAS (Certificate Authority Service) to sign the workload certificates.</p><p>This approach enables the same root of trust for the root CA&rsquo;s workloads in GCP CAS. As Istio signs the workload certs, the latency for getting workload certs issued is far less than directly getting the certs signed by ACM Private CA itself.</p><p>The <a href=/getmesh-cli/reference/getmesh_gen-ca><code>getmesh gen-ca</code></a> command furnishes the options to connect to ACM Private CA and get the intermediary CA cert signed. It uses the certificate details thus obtained to create the <strong>cacerts</strong> Kubernetes secret for Istio to use to sign workload certs. Istio, at startup, checks for the presence of the secret <strong>cacerts</strong> to decide if it needs to use this cert for signing workload certificates.</p><h2 id=prerequisites>Prerequisites</h2><p>To follow this tutorial, you will need a Google Cloud Platform account and a Kubernetes cluster with Istio installed and the following:</p><ul><li>A CA set up in GCP CAS</li><li>GCP credentials file and the environment variable <code>GOOGLE_APPLICATION_CREDENTIALS</code> pointed to the crednetials to get the CSR with CA set signed by the GCP CAS. Refer to the <a href=https://cloud.google.com/docs/authentication/getting-started>Getting started with authentication</a> documentation on how to setup the GCP credentials.</li></ul><p>You can follow the <a href=/istio-in-practice/prerequisites>prerequisites</a> for instructions on how to install and setup Istio.</p><details><summary><strong>Click here, if you need to set up GCP CA</strong></summary><h3 id=setting-up-cas>Setting up CAS</h3><p>The first thing we need is to set up the CAS in Google Cloud Console. Log in to your Google Cloud account and follow the steps below to create a CAS instance.</p><ol><li>From the navigation menu, select Security → Certificate Authority Service.</li><li>Click the <strong>Create CA</strong> button.</li><li>Configure the CA type:<ol><li>Select <strong>Root CA</strong>.</li><li>Select <strong>365 days</strong> for validity.</li><li>Select the <strong>Enterprise</strong> tier.</li><li>Select the CAS&rsquo;s location from the <strong>Location</strong> list (e.g. <code>us-east1</code>).</li><li>Click <strong>Next</strong>.</li></ol></li><li>Configure the CA subject name (you can use your values here):<ol><li>For <strong>Organization (O)</strong>, enter <strong>Istio</strong>.</li><li>For <strong>Organization unit (OU)</strong>, enter <strong>engineering</strong>.</li><li>For <strong>Country name (C)</strong>, enter <strong>US</strong>.</li><li>For <strong>Locality name</strong>, enter <strong>Sunnyvale</strong>.</li><li>For <strong>CA Common name (CN)</strong>, enter <strong>getmesh.example.io</strong>.</li><li>For <strong>Resource ID</strong>, enter <strong>getmesh-example-io</strong>.</li><li>Click <strong>Next</strong>.</li></ol></li><li>Configure the CA key size and algorithm:<ol><li>Select <strong>RSA PKCS1 2048 (SHA 256)</strong>.</li><li>Click <strong>Next</strong>.</li></ol></li><li>Click the <strong>Create</strong> button to create the CAS.</li></ol><p>The figure below shows the summary page. Note that your page might look different if you configured your own CA subject name.</p><p><img src=./cas-summary.png alt="CAS Summary Page"></p><h3 id=configure-gcp-credentials>Configure GCP credentials</h3><p>Ensure you have GCP credentials set up (e.g.<code>GOOGLE_APPLICATION_CREDENTIALS</code> environment variable has to point to the credentials) on a machine you&rsquo;re accessing the Kubernetes cluster from. Alternatively, if you installed Tetrate Istio Distro on Google Cloud Shell, the credentials are already set up.</p></details><h2 id=creating-cas-configuration>Creating CAS configuration</h2><p>We will use a YAML configuration to configure CAS and CSR creation. Use the YAML below as a template, and enter the CAS information from the CAS summary page on GCP:</p><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#268bd2>providerName</span>: <span style=color:#2aa198>&#39;gcp&#39;</span>
<span style=color:#268bd2>providerConfig</span>:
  <span style=color:#268bd2>gcp</span>:
    <span style=color:#586e75># This will hold the full CA name for the certificate authority you created on GCP</span>
    <span style=color:#268bd2>casCAName</span>: <span style=color:#2aa198>&#39;projects/tetrate-io-istio/locations/us-west1/certificateAuthorities/getmesh-example-com&#39;</span>

<span style=color:#268bd2>certificateParameters</span>:
  <span style=color:#268bd2>secretOptions</span>:
    <span style=color:#268bd2>istioCANamespace</span>: <span style=color:#2aa198>&#39;istio-system&#39;</span> <span style=color:#586e75># namespace where `cacerts` secrets live</span>
    <span style=color:#268bd2>overrideExistingCACertsSecret</span>: <span style=color:#cb4b16>true</span> <span style=color:#586e75># overwrites the existing `cacerts` secret and replaces it with this new one</span>
  <span style=color:#268bd2>caOptions</span>:
    <span style=color:#268bd2>validityDays</span>: <span style=color:#2aa198>365</span> <span style=color:#586e75># validity days before the CA expires</span>
    <span style=color:#268bd2>keyLength</span>: <span style=color:#2aa198>2048</span> <span style=color:#586e75># length (bits) of Key to be created</span>
    <span style=color:#268bd2>certSigningRequestParams</span>: <span style=color:#586e75># x509.CertificateRequest; most fields omitted</span>
      <span style=color:#268bd2>subject</span>:
        <span style=color:#268bd2>commonname</span>: <span style=color:#2aa198>&#39;getmesh.example.io&#39;</span>
        <span style=color:#268bd2>country</span>:
          - <span style=color:#2aa198>&#39;US&#39;</span>
        <span style=color:#268bd2>locality</span>:
          - <span style=color:#2aa198>&#39;Sunnyvale&#39;</span>
        <span style=color:#268bd2>organization</span>:
          - <span style=color:#2aa198>&#39;Istio&#39;</span>
        <span style=color:#268bd2>organizationunit</span>:
          - <span style=color:#2aa198>&#39;engineering&#39;</span>
      <span style=color:#268bd2>emailaddresses</span>:
        - <span style=color:#2aa198>&#39;youremail@example.io&#39;</span>
</code></pre></div><p>Save the above file to <code>gcp-cas-config.yaml</code> and use <code>gen-ca</code> command to create the <code>cacert</code>:</p><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>getmesh gen-ca --config-file gcp-cas-config.yaml
</code></pre></div><p>The command output should look similar to this:</p><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text>Kubernetes Secret YAML created successfully in /home/user/.getmesh/secret/getmesh-740905469.yaml
Kubernetes Secret created successfully with name: cacerts, in namespace: istio-system
</code></pre></div><p>Before continuing, make sure to delete the <code>istiod</code> Pod in the <code>istio-system</code> namespace to force it to use the created <code>cacerts</code>.</p><h3 id=try-it-out>Try it out</h3><p>If you&rsquo;ve labeled the <code>default</code> namespace for automatic sidecar injection (see <a href=/istio-in-practice/prerequisites>Prerequisites</a>), we can then deploy a sample Hello world application:</p><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>kubectl create deploy helloworld --image<span style=color:#719e07>=</span>gcr.io/tetratelabs/hello-world:1.0.0
</code></pre></div><p>Wait for the Pod to start and then get the certificate chain and CA root certificate proxies use for mTLS. We will save them in the <code>proxy_secret</code> file:</p><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>getmesh istioctl pc secret <span style=color:#719e07>[</span>pod-name<span style=color:#719e07>]</span> -o json &gt; proxy_secret
</code></pre></div><p>The CA root certificate is base64 encoded in the <code>trustedCA</code> field. For example:</p><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text>...
{
            &#34;name&#34;: &#34;ROOTCA&#34;,
            &#34;versionInfo&#34;: &#34;2021-02-09 04:11:42.776876959 +0000 UTC m=+0.407526692&#34;,
            &#34;lastUpdated&#34;: &#34;2021-02-09T04:11:42.783Z&#34;,
            &#34;secret&#34;: {
                &#34;@type&#34;: &#34;type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret&#34;,
                &#34;name&#34;: &#34;ROOTCA&#34;,
                &#34;validationContext&#34;: {
                    &#34;trustedCa&#34;: {
<span style=display:block;width:100%;background-color:#19404a>                        &#34;inlineBytes&#34;: &#34;&lt;base64 encoded value&gt;&#34;
</span>                    }
                }
            }
</code></pre></div><p>Store the decoded value to the <code>encodedCA.crt</code> file and then use <code>openssl</code> to decrypt the certificate into a more readable form:</p><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>openssl x509 -text -noout -in  encodedCA.crt
</code></pre></div><p>The output will include the common name, organization and other values we set in the CAS:</p><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text>Certificate:
    Data:
        Version: 3 (0x2)
        Serial Number:
            55:7f:b3:00:f8:b2:24:50:dc:51:7c:e5:85:5a:14:7a:65:28:26:38
        Signature Algorithm: sha256WithRSAEncryption
<span style=display:block;width:100%;background-color:#19404a>        Issuer: C = US, L = Sunnyvale, O = Istio, OU = engineering, CN = getmesh.example.io
</span>        Validity
            Not Before: Feb 10 17:24:51 2021 GMT
            Not After : Feb 10 17:24:51 2022 GMT
<span style=display:block;width:100%;background-color:#19404a>        Subject: C = US, L = Sunnyvale, O = Istio, OU = engineering, CN = getmesh.example.io
</span>        Subject Public Key Info:
            Public Key Algorithm: rsaEncryption
                RSA Public-Key: (2048 bit)
...
</code></pre></div><p>Similarly, if you go to CAS instance in Google Cloud Console, you&rsquo;ll notice the issued certificate under <strong>Issued Certificates</strong> tab, as shown in the figure below. Notice the <code>ca.istio.io</code> domain.</p><p><img src=issued-certs.png alt="CAS Issued Certificate"></p></div><nav class=pagination><a class="nav nav-prev" href=/istio-ca-certs-integrations/acmpca-integration/><i class="ti-arrow-left mr-2"></i>
<span class="d-none d-md-block">AWS Private CA Integration</span></a>
<a class="nav nav-next" href=/istio-ca-certs-integrations/cert-manager-integration/><span class="d-none d-md-block">cert-manager CA Integration</span><i class="ti-arrow-right ml-2"></i></a></nav></div></div></div></div></section><footer><div class=container><div class="row align-items-center pb-0 footer-logo"><a class=navbar-brand href=/><img id=getistio-footer-logo class=img-fluid src=/images/tetrate-istio-distro-logo.png alt="Tetrate Istio Distro | Simple, safe enterprise-grade Istio"></a>
<a href=https://www.tetrate.io target=_blank><img id=tetrate-footer-logo class=img-fluid src=/images/tetrate-logo.svg alt="Tetrate Logo"></a></div><div class="py-4 text-center"><div class=mb-4><ul class="list-inline social-icons text-lg-center text-center"><li class=list-inline-item><a href=https://www.tetrate.io/ target=_blank aria-label="Tetrate website"><i class=ti-world></i></a></li><li class=list-inline-item><a href=https://www.twitter.com/tetrateio target=_blank aria-label="Tetrate Twitter account"><i class=ti-twitter-alt></i></a></li><li class=list-inline-item><a href=https://www.github.com/tetratelabs target=_blank aria-label="Tetrate Github account"><i class=ti-github></i></a></li><li class=list-inline-item><a href=https://www.linkedin.com/company/tetrate/ target=_blank aria-label="Tetrate LinkedIn account"><i class=ti-linkedin></i></a></li></ul></div><small class=text-white>Support: Join our <a href=https://tetr8.io/tetrate-community target=_blank>#tid-and-getmesh Slack Channel</a> for Community Support</small><br><small class=text-white>License: Tetrate Istio Distro is an open source project and is released under Apache License 2.0 | <a href=https://www.tetrate.io/privacy target=_blank>Privacy Statement</a></small><br><small class=text-white>Official project site of istio is <a href=https://www.istio.io target=_blank>istio.io</a></small><br><small class=text-white>Copyright &copy; 2023 <a href=https://www.tetrate.io target=_blank>Tetrate</a> All rights reserved.</small></div></div></footer><script type=text/javascript>var indexURL="/index.json",baseurl="https://istio.tetratelabs.io/"</script><script src=/plugins/jQuery/jquery.min.js></script><script src=/plugins/bootstrap/bootstrap.min.js></script><script src=/plugins/featherlight/featherlight.min.js></script><script src=/plugins/clipboard/clipboard.min.js></script><script src=/plugins/match-height/jquery.matchHeight-min.js></script><script src=/plugins/search/auto-complete.js></script><script src=/plugins/search/search.js></script><script src=/plugins/search/lunr.min.js></script><script src=/plugins/search/fuse.min.js></script><script src=/plugins/search/mark.js></script><script src=/plugins/search/search-page.js></script><script src=/js/script.min.js></script><script src=/js/form.min.js></script><script type=text/javascript src="//js.hsforms.net/forms/v2.js?pre=1"></script><script async defer src=https://buttons.github.io/buttons.js></script></body></html>