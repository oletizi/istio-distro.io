<!doctype html><html lang=en-us><head><meta charset=utf-8><title itemprop=name>How to set up SSL Certificates | GetIstio by Tetrate | Simple, safe enterprise-grade Istio distro</title><meta name=twitter:title content="How to set up SSL Certificates | GetIstio by Tetrate | Simple, safe enterprise-grade Istio distro"><meta itemprop=name content="How to set up SSL Certificates | GetIstio by Tetrate | Simple, safe enterprise-grade Istio distro"><meta name=application-name content="How to set up SSL Certificates | GetIstio by Tetrate | Simple, safe enterprise-grade Istio distro"><meta property="og:site_name" content="Tetrate Istio Distro"><meta name=description content="Tetrate Istio Distro project provides a simple, safe, enterprise-grade Istio distro."><meta itemprop=description content="Tetrate Istio Distro project provides a simple, safe, enterprise-grade Istio distro."><meta name=twitter:description content="Tetrate Istio Distro project provides a simple, safe, enterprise-grade Istio distro."><meta property="og:locale" content="en"><meta name=language content="En"><link rel=alternate hreflang=en href=/istio-in-practice/setting-up-ssl-certs/><link rel=alternate hreflang=zh href=/zh/istio-in-practice/setting-up-ssl-certs/><meta property="og:updated_time" content="2021-01-01T11:02:05+0600"><link rel=sitemap type=application/xml title=Sitemap href=/sitemap.xml><link href=/istio-in-practice/setting-up-ssl-certs/index.xml rel=alternate type=application/rss+xml title="Tetrate Istio Distro | Simple, safe enterprise-grade Istio"><link href=/istio-in-practice/setting-up-ssl-certs/index.xml rel=feed type=application/rss+xml title="Tetrate Istio Distro | Simple, safe enterprise-grade Istio"><meta property="og:type" content="website"><meta name=author content="Tetrate"><script defer type=application/ld+json>{"@context":"http://schema.org","@type":"WebSite","url":"https:\/\/istio.tetratelabs.io\/istio-in-practice\/setting-up-ssl-certs\/","sameAs":["","https:\/\/github.com\/tetratelabs\/getmesh"],"name":"Tetrate Istio Distro | Simple, safe enterprise-grade Istio","logo":"https://getistio.io/images/getistio-by-tetrate-logo.png"}</script><meta name=robots content="index,follow"><meta name=googlebot content="index,follow"><meta name=twitter:site content="@tetrateio"><meta name=twitter:creator content="@tetrateio"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=5"><meta name=generator content="Hugo 0.85.0"><script async src="https://www.googletagmanager.com/gtag/js?id=G-P3J9XNBME4"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-P3J9XNBME4')</script><link rel=preload href=/plugins/themify-icons/themify-icons.css as=style onload="this.onload=null,this.rel='stylesheet'"><noscript><link rel=stylesheet href=/plugins/themify-icons/themify-icons.css></noscript><link rel=preload href=/plugins/search/auto-complete.css as=style onload="this.onload=null,this.rel='stylesheet'"><noscript><link rel=stylesheet href=/plugins/search/auto-complete.css></noscript><link rel=preload href=/plugins/featherlight/featherlight.min.css as=style onload="this.onload=null,this.rel='stylesheet'"><noscript><link rel=stylesheet href=/plugins/featherlight/featherlight.min.css></noscript><link rel=preload href=/css/bootstrap/bootstrap.min.css as=style onload="this.onload=null,this.rel='stylesheet'"><noscript><link rel=stylesheet href=/css/bootstrap/bootstrap.min.css></noscript><link rel=preload href=/scss/style.css as=style onload="this.onload=null,this.rel='stylesheet'"><noscript><link rel=stylesheet href=/scss/style.css></noscript><link rel="shortcut icon" href=/images/getistio-favicon.png type=image/x-icon><link rel=icon href=/images/getistio-favicon.png type=image/x-icon><meta property="og:title" content="How to set up SSL Certificates"><meta property="og:description" content="Tetrate Istio Distro project provides a simple, safe, enterprise-grade Istio distro."><meta property="og:type" content="website"><meta property="og:url" content="https://istio.tetratelabs.io/istio-in-practice/setting-up-ssl-certs/"><meta property="og:image" content="https://istio.tetratelabs.io/images/twitter-card-new.png"><script async defer src=/js/turbolinks.min.js></script></head><body><header class="sticky-top navigation"><div class=my-container><nav class="navbar navbar-expand-lg navbar-light bg-transparent"><div class=navbar-brand-container><a class=navbar-brand href=/><img class="img-fluid logo-width" src=/images/tetrate-istio-distro-logo.png alt="Tetrate Istio Distro | Simple, safe enterprise-grade Istio"></a>
<a class=github-button href=https://github.com/tetratelabs/getistio data-icon=octicon-star aria-label="Star tetratelabs/getmesh on GitHub">Star</a></div><button aria-label=Menu class="navbar-toggler border-0" type=button data-toggle=collapse data-target=#navigation>
<i class="ti-menu h4 text-white"></i></button><div class="collapse navbar-collapse text-center" id=navigation><ul class="navbar-nav mx-auto align-items-center"><li class=nav-item><a class=nav-link href=/getmesh-cli/>Docs</a></li><li class=nav-item><a class=nav-link href=/blog/>Blog</a></li><li class=nav-item><a class=nav-link href=/community-events/>Community</a></li><li class=nav-item><a class=nav-link href=https://academy.tetrate.io target=_blank>Training</a></li><li class=nav-item><a class=nav-link href=https://func-e.io/ target=_blank>func-e</a></li><li class=nav-item><a class=nav-link href=https://www.istio.io/ target=_blank>Istio.io</a></li><li class=nav-link><select class=nav-item id=select-language onchange="location=this.value"><option id=en value=/istio-in-practice/setting-up-ssl-certs/ selected>En</option><option id=zh value=/zh/istio-in-practice/setting-up-ssl-certs/>中文</option></select></li></ul><div class="d-lg-none d-block"><a href=/download class="btn btn-sm btn-primary ml-lg-4">download</a></div></div><div class="d-lg-flex d-none"><a href=/download class="btn btn-sm btn-primary ml-lg-4">Download</a></div></nav></div></header><section class=pt-5><div class="container d-block d-sm-block d-lg-none"><div class="row justify-content-center mb-4"><div><button onclick=dropdownFunction() class="btn btn-primary dropdown-toggle nav-dropdown">Browse Docs
<span class=caret></span></button><ul id=mobileDropdownMenu class=dropdown-content><li data-nav-id=/introduction/ title=Introduction class="sidelist my-2"><a href=/introduction/>Introduction</a></li><li data-nav-id=/quickstart/ title="TID Quickstart" class="sidelist my-2"><a href=/quickstart/>TID Quickstart</a></li><li data-nav-id=/mgmt-tasks/ title="Common Management Tasks" class="sidelist my-2"><a href=/mgmt-tasks/>Common Management Tasks</a></li><li data-nav-id=/getmesh-cli/ title="GetMesh Documentation" class="sidelist my-2"><a href=/getmesh-cli/>GetMesh Documentation</a></li><li data-nav-id=/istio-in-practice/ title="Istio in Practice" class="sidelist parent my-2"><a href=/istio-in-practice/>Istio in Practice</a></li><li data-nav-id=/istio-ca-certs-integrations/ title="Istio CA Certs Integration" class="sidelist my-2"><a href=/istio-ca-certs-integrations/>Istio CA Certs Integration</a></li><li data-nav-id=/istio-cheatsheet/ title="Istio Hints and Tips" class="sidelist my-2"><a href=/istio-cheatsheet/>Istio Hints and Tips</a></li><li data-nav-id=/helm/ title="Helm Chart Deployment" class="sidelist my-2"><a href=/helm/>Helm Chart Deployment</a></li><li data-nav-id=/download/ title=Downloads class="sidelist my-2"><a href=/download/>Downloads</a></li><li data-nav-id=/faq/ title=FAQs class="sidelist my-2"><a href=/faq/>FAQs</a></li><li data-nav-id=/community/ title=Community class="sidelist my-2"><a href=/community/>Community</a></li><li data-nav-id=/fips-request/ title="FIPS Download Request" class="sidelist my-2"><a href=/fips-request/>FIPS Download Request</a></li></ul></div></div></div><div class="container shadow section-sm rounded docs-content"><div class=row><div class="col-lg-3 d-none d-md-none d-lg-block"><ul class=sidenav><li data-nav-id=/introduction/ title=Introduction class=sidelist><a href=/introduction/>Introduction</a><ul><li data-nav-id=/introduction/intro/ title class=sidelist><a href=/introduction/intro/></a></ul></li><li data-nav-id=/quickstart/ title="TID Quickstart" class=sidelist><a href=/quickstart/>TID Quickstart</a><ul><li data-nav-id=/quickstart/start/ title class=sidelist><a href=/quickstart/start/></a></ul></li><li data-nav-id=/mgmt-tasks/ title="Common Management Tasks" class=sidelist><a href=/mgmt-tasks/>Common Management Tasks</a><ul><li data-nav-id=/mgmt-tasks/install-istio-updates/ title="Install Istio Updates" class=sidelist><a href=/mgmt-tasks/install-istio-updates/>Install Istio Updates</a><li data-nav-id=/mgmt-tasks/install-istio-and-manage-multiple-istioctl/ title="Manage multiple istioctl" class=sidelist><a href=/mgmt-tasks/install-istio-and-manage-multiple-istioctl/>Manage multiple istioctl</a><li data-nav-id=/mgmt-tasks/config-validation/ title="Config Validation" class=sidelist><a href=/mgmt-tasks/config-validation/>Config Validation</a></ul></li><li data-nav-id=/getmesh-cli/ title="GetMesh Documentation" class=sidelist><a href=/getmesh-cli/>GetMesh Documentation</a><ul><li data-nav-id=/getmesh-cli/install/ title="Install GetMesh and Istio" class=sidelist><a href=/getmesh-cli/install/>Install GetMesh and Istio</a><ul><li data-nav-id=/getmesh-cli/install/install-istio/ title="Install Istio" class=sidelist><a href=/getmesh-cli/install/install-istio/>Install Istio</a><ul><li data-nav-id=/getmesh-cli/install/install-istio/prepare-eks-cluster/ title="Prepare AWS EKS cluster" class=sidelist><a href=/getmesh-cli/install/install-istio/prepare-eks-cluster/>Prepare AWS EKS cluster</a><li data-nav-id=/getmesh-cli/install/install-istio/aks-tid-deployment/ title="Install Istio on Azure AKS" class=sidelist><a href=/getmesh-cli/install/install-istio/aks-tid-deployment/>Install Istio on Azure AKS</a><li data-nav-id=/getmesh-cli/install/install-istio/eks-addon/ title="Install Istio in EKS with add-on" class=sidelist><a href=/getmesh-cli/install/install-istio/eks-addon/>Install Istio in EKS with add-on</a><li data-nav-id=/getmesh-cli/install/install-istio/deploy-gateway/ title="Deploy Istio Gateway in EKS" class=sidelist><a href=/getmesh-cli/install/install-istio/deploy-gateway/>Deploy Istio Gateway in EKS</a></ul></li><li data-nav-id=/getmesh-cli/install/install-and-update/ title="GetMesh installation and update" class=sidelist><a href=/getmesh-cli/install/install-and-update/>GetMesh installation and update</a><li data-nav-id=/getmesh-cli/install/post-install/ title="Once you've installed Istio" class=sidelist><a href=/getmesh-cli/install/post-install/>Once you've installed Istio</a></ul></li><li data-nav-id=/getmesh-cli/reference/ title=Reference class=sidelist><a href=/getmesh-cli/reference/>Reference</a><ul><li data-nav-id=/getmesh-cli/reference/getmesh/ title=GetMesh class=sidelist><a href=/getmesh-cli/reference/getmesh/>GetMesh</a><li data-nav-id=/getmesh-cli/reference/getmesh_check-upgrade/ title="getmesh check-upgrade" class=sidelist><a href=/getmesh-cli/reference/getmesh_check-upgrade/>getmesh check-upgrade</a><li data-nav-id=/getmesh-cli/reference/getmesh_config-validate/ title="getmesh config-validate" class=sidelist><a href=/getmesh-cli/reference/getmesh_config-validate/>getmesh config-validate</a><li data-nav-id=/getmesh-cli/reference/getmesh_default-hub/ title="getmesh default-hub" class=sidelist><a href=/getmesh-cli/reference/getmesh_default-hub/>getmesh default-hub</a><li data-nav-id=/getmesh-cli/reference/getmesh_fetch/ title="getmesh fetch" class=sidelist><a href=/getmesh-cli/reference/getmesh_fetch/>getmesh fetch</a><li data-nav-id=/getmesh-cli/reference/getmesh_gen-ca/ title="getmesh gen-ca" class=sidelist><a href=/getmesh-cli/reference/getmesh_gen-ca/>getmesh gen-ca</a><li data-nav-id=/getmesh-cli/reference/getmesh_help/ title="getmesh help" class=sidelist><a href=/getmesh-cli/reference/getmesh_help/>getmesh help</a><li data-nav-id=/getmesh-cli/reference/getmesh_istioctl/ title="getmesh istioctl" class=sidelist><a href=/getmesh-cli/reference/getmesh_istioctl/>getmesh istioctl</a><li data-nav-id=/getmesh-cli/reference/getmesh_list/ title="getmesh list" class=sidelist><a href=/getmesh-cli/reference/getmesh_list/>getmesh list</a><li data-nav-id=/getmesh-cli/reference/getmesh_prune/ title="getmesh prune" class=sidelist><a href=/getmesh-cli/reference/getmesh_prune/>getmesh prune</a><li data-nav-id=/getmesh-cli/reference/getmesh_show/ title="getmesh show" class=sidelist><a href=/getmesh-cli/reference/getmesh_show/>getmesh show</a><li data-nav-id=/getmesh-cli/reference/getmesh_switch/ title="getmesh switch" class=sidelist><a href=/getmesh-cli/reference/getmesh_switch/>getmesh switch</a><li data-nav-id=/getmesh-cli/reference/getmesh_version/ title="getmesh version" class=sidelist><a href=/getmesh-cli/reference/getmesh_version/>getmesh version</a></ul></li></ul></li><li data-nav-id=/istio-in-practice/ title="Istio in Practice" class="sidelist parent"><a href=/istio-in-practice/>Istio in Practice</a><ul><li data-nav-id=/istio-in-practice/prerequisites/ title=Prerequisites class=sidelist><a href=/istio-in-practice/prerequisites/>Prerequisites</a><li data-nav-id=/istio-in-practice/zero-downtime-releases/ title="How to do Zero-Downtime Releases" class=sidelist><a href=/istio-in-practice/zero-downtime-releases/>How to do Zero-Downtime Releases</a><li data-nav-id=/istio-in-practice/traffic-mirroring/ title="How to use Traffic Mirroring" class=sidelist><a href=/istio-in-practice/traffic-mirroring/>How to use Traffic Mirroring</a><li data-nav-id=/istio-in-practice/sticky-sessions/ title="How to use Sticky Sessions" class=sidelist><a href=/istio-in-practice/sticky-sessions/>How to use Sticky Sessions</a><li data-nav-id=/istio-in-practice/setting-up-ssl-certs/ title="How to set up SSL Certificates" class="sidelist parent active"><a href=/istio-in-practice/setting-up-ssl-certs/>How to set up SSL Certificates</a><li data-nav-id=/istio-in-practice/multiple-ingress-gateways/ title="How to Deploy Multiple Istio Ingress Gateways" class=sidelist><a href=/istio-in-practice/multiple-ingress-gateways/>How to Deploy Multiple Istio Ingress Gateways</a><li data-nav-id=/istio-in-practice/aws-cloudmap-integration/ title="Integrate AWS Cloud Map with Istio" class=sidelist><a href=/istio-in-practice/aws-cloudmap-integration/>Integrate AWS Cloud Map with Istio</a><li data-nav-id=/istio-in-practice/install-skywalking/ title="Integration with Apache SkyWalking" class=sidelist><a href=/istio-in-practice/install-skywalking/>Integration with Apache SkyWalking</a></ul></li><li data-nav-id=/istio-ca-certs-integrations/ title="Istio CA Certs Integration" class=sidelist><a href=/istio-ca-certs-integrations/>Istio CA Certs Integration</a><ul><li data-nav-id=/istio-ca-certs-integrations/acmpca-integration/ title="AWS Private CA Integration" class=sidelist><a href=/istio-ca-certs-integrations/acmpca-integration/>AWS Private CA Integration</a><li data-nav-id=/istio-ca-certs-integrations/gcp-cas-integration/ title="GCP CA Integration" class=sidelist><a href=/istio-ca-certs-integrations/gcp-cas-integration/>GCP CA Integration</a><li data-nav-id=/istio-ca-certs-integrations/cert-manager-integration/ title="cert-manager CA Integration" class=sidelist><a href=/istio-ca-certs-integrations/cert-manager-integration/>cert-manager CA Integration</a></ul></li><li data-nav-id=/istio-cheatsheet/ title="Istio Hints and Tips" class=sidelist><a href=/istio-cheatsheet/>Istio Hints and Tips</a><ul><li data-nav-id=/istio-cheatsheet/cheatsheet/ title class=sidelist><a href=/istio-cheatsheet/cheatsheet/></a></ul></li><li data-nav-id=/helm/ title="Helm Chart Deployment" class=sidelist><a href=/helm/>Helm Chart Deployment</a><ul><li data-nav-id=/helm/charts/ title class=sidelist><a href=/helm/charts/></a></ul></li><li data-nav-id=/download/ title=Downloads class=sidelist><a href=/download/>Downloads</a><ul><li data-nav-id=/download/downloads/ title class=sidelist><a href=/download/downloads/></a></ul></li><li data-nav-id=/faq/ title=FAQs class=sidelist><a href=/faq/>FAQs</a><ul><li data-nav-id=/faq/questions/ title class=sidelist><a href=/faq/questions/></a></ul></li><li data-nav-id=/community/ title=Community class=sidelist><a href=/community/>Community</a><ul><li data-nav-id=/community/event/getistio-inaugural/ title="What is GetIstio - Inaugural Community Meetup" class=sidelist><a href=/community/event/getistio-inaugural/>What is GetIstio - Inaugural Community Meetup</a><li data-nav-id=/community/event/istiocon-2021/ title="IstioCon 2021" class=sidelist><a href=/community/event/istiocon-2021/>IstioCon 2021</a><li data-nav-id=/community/event/getenvoy-deep-dive/ title="Effortless Envoy and WASM with GetEnvoy" class=sidelist><a href=/community/event/getenvoy-deep-dive/>Effortless Envoy and WASM with GetEnvoy</a><li data-nav-id=/community/event/getistio-deep-dive/ title="Istio the Easy Way with GetIstio" class=sidelist><a href=/community/event/getistio-deep-dive/>Istio the Easy Way with GetIstio</a><li data-nav-id=/community/event/tid-episode-003/ title="SSL Certificates in Istio Ingress Gateway" class=sidelist><a href=/community/event/tid-episode-003/>SSL Certificates in Istio Ingress Gateway</a><li data-nav-id=/community/event/tid-episode-004/ title="Deploying multiple Istio ingress gateways" class=sidelist><a href=/community/event/tid-episode-004/>Deploying multiple Istio ingress gateways</a><li data-nav-id=/community/event/tid-episode-006/ title="Istio Big Talk Episode 4" class=sidelist><a href=/community/event/tid-episode-006/>Istio Big Talk Episode 4</a><li data-nav-id=/community/event/tid-episode-005/ title="Security in Istio" class=sidelist><a href=/community/event/tid-episode-005/>Security in Istio</a><li data-nav-id=/community/event/tid-episode-007/ title="Istio Big Talk Episode 5" class=sidelist><a href=/community/event/tid-episode-007/>Istio Big Talk Episode 5</a><li data-nav-id=/community/event/tid-episode-008/ title="Istio Weekly Episode 6: Envoy Fundamentals" class=sidelist><a href=/community/event/tid-episode-008/>Istio Weekly Episode 6: Envoy Fundamentals</a><li data-nav-id=/community/event/tid-episode-009/ title="Episode 07: Developing Envoy Wasm Extensions" class=sidelist><a href=/community/event/tid-episode-009/>Episode 07: Developing Envoy Wasm Extensions</a><li data-nav-id=/community/event/tid-episode-010/ title="Istio in the enterprise: Solving security and scale challenges for microservices in Kubernetes" class=sidelist><a href=/community/event/tid-episode-010/>Istio in the enterprise: Solving security and scale challenges for microservices in Kubernetes</a><li data-nav-id=/community/event/tid-episode-011/ title="Episode 08: External CA with Istio" class=sidelist><a href=/community/event/tid-episode-011/>Episode 08: External CA with Istio</a><li data-nav-id=/community/event/tid-episode-012/ title="Episode 09: Customizing Istio metrics" class=sidelist><a href=/community/event/tid-episode-012/>Episode 09: Customizing Istio metrics</a><li data-nav-id=/community/event/tid-episode-013/ title class=sidelist><a href=/community/event/tid-episode-013/></a><li data-nav-id=/community/event/tid-episode-016/ title="Access Control for Microservices" class=sidelist><a href=/community/event/tid-episode-016/>Access Control for Microservices</a><li data-nav-id=/community/building-and-testing/ title="Building and Testing" class=sidelist><a href=/community/building-and-testing/>Building and Testing</a><li data-nav-id=/community/contributing/ title="Contributing to GetMesh" class=sidelist><a href=/community/contributing/>Contributing to GetMesh</a><li data-nav-id=/community/event/tid-episode-014/ title="Episode 11: Enterprise service mesh and why you need it" class=sidelist><a href=/community/event/tid-episode-014/>Episode 11: Enterprise service mesh and why you need it</a><li data-nav-id=/community/event/tid-episode-015/ title="Episode 12: How I started contributing to Istio and Envoy" class=sidelist><a href=/community/event/tid-episode-015/>Episode 12: How I started contributing to Istio and Envoy</a><li data-nav-id=/community/event/tid-episode-018/ title="Episode 15: Setting up Istio with external control plane" class=sidelist><a href=/community/event/tid-episode-018/>Episode 15: Setting up Istio with external control plane</a><li data-nav-id=/community/event/tid-episode-017/ title="Istio's new Wasm-based extension mechanism and ecosystem" class=sidelist><a href=/community/event/tid-episode-017/>Istio's new Wasm-based extension mechanism and ecosystem</a></ul></li><li data-nav-id=/fips-request/ title="FIPS Download Request" class=sidelist><a href=/fips-request/>FIPS Download Request</a><ul><li data-nav-id=/fips-request/fips/ title class=sidelist><a href=/fips-request/fips/></a></ul></li></ul></div><div class=col-lg-9><div class="px-lg-5 px-4"><h1 class="mb-4 font-weight-medium">How to set up SSL Certificates</h1><div class=content><p>SSL certificates are a must these days. They help protect the data that&rsquo;s sent between the server and the client by encrypting it, which gives your website more credibility. This section will explore a couple of different ways to obtain SSL certificates and configure the <a href=https://istio.io/latest/docs/reference/config/networking/gateway/>Istio Gateway</a> to use them.</p><p>We will learn how to manually create a self-signed certificate, followed by obtaining a real SSL certificate and setting that up as well. As you will see, setting all this up is not too complicated.</p><h2 id=prerequisites>Prerequisites</h2><p>For you to follow along, you will need an actual, cloud-hosted Kubernetes cluster. A cloud-hosted cluster is required because we will need an external IP address to hook up a domain name to. Of course, you will also need a domain name.</p><p>You can follow the <a href=/istio-in-practice/prerequisites>prerequisites</a> for instructions on how to install and setup Istio.</p><h2 id=deploying-a-sample-application>Deploying a sample application</h2><p>To ensure stuff works as it should, we will start by deploying a simple Hello World web application. If you have your own application/service you want to use, feel free to use that. Otherwise, you can follow along and use the <code>gcr.io/tetratelabs/hello-world:1.0.0</code> image.</p><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>kubectl create deploy helloworld --image<span style=color:#719e07>=</span>gcr.io/tetratelabs/hello-world:1.0.0 --port<span style=color:#719e07>=</span><span style=color:#2aa198>3000</span>
</code></pre></div><p>Next, let&rsquo;s create a Kubernetes Service for it.</p><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#268bd2>apiVersion</span>: v1
<span style=color:#268bd2>kind</span>: Service
<span style=color:#268bd2>metadata</span>:
  <span style=color:#268bd2>name</span>: helloworld
  <span style=color:#268bd2>labels</span>:
    <span style=color:#268bd2>app</span>: helloworld
<span style=color:#268bd2>spec</span>:
  <span style=color:#268bd2>ports</span>:
  - <span style=color:#268bd2>name</span>: http
    <span style=color:#268bd2>port</span>: <span style=color:#2aa198>80</span>
    <span style=color:#268bd2>targetPort</span>: <span style=color:#2aa198>3000</span>
  <span style=color:#268bd2>selector</span>:
    <span style=color:#268bd2>app</span>: helloworld
</code></pre></div><p>Copy the above YAML to <code>helloworld-svc.yaml</code> and deploy it using <code>kubectl apply -f helloworld-svc.yaml</code>.</p><blockquote><p>Note we&rsquo;re not using <code>kubectl expose</code> command because we need to name the ports in Kubernetes services (e.g. <code>http</code>), and we can&rsquo;t do that through the expose command.</p></blockquote><p>To access the service from an external IP, we also need a Gateway resource:</p><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#268bd2>apiVersion</span>: networking.istio.io/v1alpha3
<span style=color:#268bd2>kind</span>: Gateway
<span style=color:#268bd2>metadata</span>:
  <span style=color:#268bd2>name</span>: public-gateway
<span style=color:#268bd2>spec</span>:
  <span style=color:#268bd2>selector</span>:
    <span style=color:#268bd2>istio</span>: ingressgateway
  <span style=color:#268bd2>servers</span>:
    - <span style=color:#268bd2>port</span>:
        <span style=color:#268bd2>number</span>: <span style=color:#2aa198>80</span>
        <span style=color:#268bd2>name</span>: http
        <span style=color:#268bd2>protocol</span>: HTTP
      <span style=color:#268bd2>hosts</span>:
        - <span style=color:#2aa198>&#39;*&#39;</span>
</code></pre></div><p>Save the above YAML to <code>gateway.yaml</code> and deploy it using <code>kubectl apply -f gateway.yaml</code>.</p><blockquote><p>Note: the <code>hosts</code> field has a value of <code>*</code>. We will change the value of this field after we create the SSL certificate for the domain name. The value will be the actual domain name.</p></blockquote><p>Finally, we also need a VirtualService that routes the traffic to the <code>helloworld</code> Kubernetes Service:</p><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#268bd2>apiVersion</span>: networking.istio.io/v1alpha3
<span style=color:#268bd2>kind</span>: VirtualService
<span style=color:#268bd2>metadata</span>:
  <span style=color:#268bd2>name</span>: helloworld
<span style=color:#268bd2>spec</span>:
  <span style=color:#268bd2>hosts</span>:
    - <span style=color:#2aa198>&#39;*&#39;</span>
  <span style=color:#268bd2>gateways</span>:
    - public-gateway
  <span style=color:#268bd2>http</span>:
    - <span style=color:#268bd2>route</span>:
      - <span style=color:#268bd2>destination</span>:
          <span style=color:#268bd2>host</span>: helloworld.default.svc.cluster.local
          <span style=color:#268bd2>port</span>:
            <span style=color:#268bd2>number</span>: <span style=color:#2aa198>80</span>
</code></pre></div><p>Save the above YAML to <code>helloworld-vs.yaml</code> and deploy it using <code>kubectl apply -f helloworld-vs.yaml</code>.</p><p>With all these resources deployed, you can now get the external IP of the Istio&rsquo;s ingress gateway:</p><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>kubectl get svc -l <span style=color:#268bd2>istio</span><span style=color:#719e07>=</span>ingressgateway -n istio-system
</code></pre></div><p>If you open the IP that shows up in the <code>EXTERNAL-IP</code> column, you will see something similar to the figure below.</p><p><img src=not-secure.png alt="Connection is not secure"></p><p>We got a response back from the application, but we also got the <code>Not Secure</code> message from the browser, which tells the user that the connection is not secure and doesn&rsquo;t instill a lot of confidence.</p><h2 id=self-signed-certs-and-manual-setup>Self-signed certs and manual setup</h2><p>Let&rsquo;s start with the simplest scenario where we manually obtain the certificate. First thing - pick a domain you want to use - note that to test this, you don&rsquo;t have to own an actual domain name because we will use a self-signed certificate.</p><blockquote><p>A self-signed certificate is not signed by a certificate authority (CA). You&rsquo;d use these certificates for development and testing. However, they don&rsquo;t provide all of the security features that certificates signed by a CA provide.</p></blockquote><p>I will use <code>mysuperdomain.com</code> for my domain name.</p><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=color:#b58900>export</span> <span style=color:#268bd2>DOMAIN_NAME</span><span style=color:#719e07>=</span>mysuperdomain.com
</code></pre></div><p>As a first step, we are going to create the root certificate (<code>$DOMAIN_NAME.crt</code>) and the private key used for signing the certificate (<code>$DOMAIN_NAME.key</code>):</p><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>openssl req -x509 -sha256 -nodes -days <span style=color:#2aa198>365</span> -newkey rsa:2048 -subj <span style=color:#2aa198>&#39;/O=$DOMAIN_NAME Inc./CN=$DOMAIN_NAME&#39;</span> -keyout <span style=color:#268bd2>$DOMAIN_NAME</span>.key -out <span style=color:#268bd2>$DOMAIN_NAME</span>.crt
</code></pre></div><p>The above command creates a <code>.crt</code> and a <code>.key</code> file.</p><p>Next, we need to create the private key and a signing request:</p><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>openssl req -out helloworld.<span style=color:#268bd2>$DOMAIN_NAME</span>.csr -newkey rsa:2048 -nodes -keyout helloworld.<span style=color:#268bd2>$DOMAIN_NAME</span>.key -subj <span style=color:#2aa198>&#34;/CN=helloworld.</span><span style=color:#268bd2>$DOMAIN_NAME</span><span style=color:#2aa198>/O=hello world from </span><span style=color:#268bd2>$DOMAIN_NAME</span><span style=color:#2aa198>&#34;</span>
</code></pre></div><p>Finally, we can create the certificate:</p><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>openssl x509 -req -days <span style=color:#2aa198>365</span> -CA <span style=color:#268bd2>$DOMAIN_NAME</span>.crt -CAkey <span style=color:#268bd2>$DOMAIN_NAME</span>.key -set_serial <span style=color:#2aa198>0</span> -in helloworld.<span style=color:#268bd2>$DOMAIN_NAME</span>.csr -out helloworld.<span style=color:#268bd2>$DOMAIN_NAME</span>.crt
</code></pre></div><p>Now that you have the certificate and the key, you can create the Kubernetes Secret to store the certificate and the key.</p><p>The secret with certificates must be called <code>istio-ingressgateway-certs,</code> and we have to deploy it to the <code>istio-system</code> namespace. That way, the Istio ingress gateway will load the secret automatically.</p><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>kubectl create secret tls istio-ingressgateway-certs -n istio-system --key helloworld.<span style=color:#268bd2>$DOMAIN_NAME</span>.key --cert helloworld.<span style=color:#268bd2>$DOMAIN_NAME</span>.crt
</code></pre></div><p>With the secret in place, let&rsquo;s update the Gateway resource and tell it to use this certificate and private key:</p><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>cat <span style=color:#2aa198>&lt;&lt;EOF | kubectl apply -f -
</span><span style=color:#2aa198>apiVersion: networking.istio.io/v1alpha3
</span><span style=color:#2aa198>kind: Gateway
</span><span style=color:#2aa198>metadata:
</span><span style=color:#2aa198>  name: public-gateway
</span><span style=color:#2aa198>spec:
</span><span style=color:#2aa198>  selector:
</span><span style=color:#2aa198>    istio: ingressgateway
</span><span style=color:#2aa198>  servers:
</span><span style=color:#2aa198>  - port:
</span><span style=color:#2aa198>      number: 443
</span><span style=color:#2aa198>      name: https
</span><span style=color:#2aa198>      protocol: HTTPS
</span><span style=color:#2aa198>    tls:
</span><span style=color:#2aa198>      mode: SIMPLE
</span><span style=color:#2aa198>      # These are coming from the istio-ingressgateway-certs secret
</span><span style=color:#2aa198>      serverCertificate: /etc/istio/ingressgateway-certs/tls.crt
</span><span style=color:#2aa198>      privateKey: /etc/istio/ingressgateway-certs/tls.key
</span><span style=color:#2aa198>    hosts:
</span><span style=color:#2aa198>    - helloworld.$DOMAIN_NAME
</span><span style=color:#2aa198>EOF</span>
</code></pre></div><p>Similarly, we need to update the hosts field in the VirtualService with the domain name we set to the <code>$DOMAIN_NAME</code> environment variable:</p><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>cat <span style=color:#2aa198>&lt;&lt;EOF | kubectl apply -f -
</span><span style=color:#2aa198>apiVersion: networking.istio.io/v1alpha3
</span><span style=color:#2aa198>kind: VirtualService
</span><span style=color:#2aa198>metadata:
</span><span style=color:#2aa198>  name: helloworld
</span><span style=color:#2aa198>spec:
</span><span style=color:#2aa198>  hosts:
</span><span style=color:#2aa198>    - helloworld.$DOMAIN_NAME
</span><span style=color:#2aa198>  gateways:
</span><span style=color:#2aa198>    - public-gateway
</span><span style=color:#2aa198>  http:
</span><span style=color:#2aa198>    - route:
</span><span style=color:#2aa198>      - destination:
</span><span style=color:#2aa198>          host: helloworld.default.svc.cluster.local
</span><span style=color:#2aa198>          port:
</span><span style=color:#2aa198>            number: 80
</span><span style=color:#2aa198>EOF</span>
</code></pre></div><p>The simplest way to test that this works is to use cURL and the <code>--resolve</code> flag.</p><p>The resolve flag has a format of <code>[DOMAIN]:[PORT]:[IP]</code> and it routes all requests that match the <code>[DOMAIN]:[PORT]</code> portion to the specified IP address. This way, we don&rsquo;t need to go to DNS/domain registrars' website and make changes to test this, and we can use a domain that might not even exist.</p><p>The IP address in our case is the external IP address of the ingress gateway. Let&rsquo;s save the gateways' IP address to <code>EXTERNAL_IP</code> environment variable:</p><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=color:#b58900>export</span> <span style=color:#268bd2>EXTERNAL_IP</span><span style=color:#719e07>=</span><span style=color:#719e07>$(</span>kubectl get svc istio-ingressgateway -n istio-system -o <span style=color:#268bd2>jsonpath</span><span style=color:#719e07>=</span><span style=color:#2aa198>&#39;{.status.loadBalancer.ingress[0].ip}&#39;</span><span style=color:#719e07>)</span>
</code></pre></div><p>Finally, let&rsquo;s use this cURL command to test that the SSL certs get verified and used:</p><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>curl -v --resolve helloworld.<span style=color:#268bd2>$DOMAIN_NAME</span>:443:<span style=color:#268bd2>$EXTERNAL_IP</span> --cacert <span style=color:#268bd2>$DOMAIN_NAME</span>.crt https://helloworld.<span style=color:#268bd2>$DOMAIN_NAME</span>
</code></pre></div><p>We are telling cURL to resolve any requests to <code>helloworld.mysuperdomain.com:443</code> to the external IP address of the ingress gateway with the above command. Additionally, we are providing the name of the CA certificate we created earlier.</p><p>From the output, you will be able to see the details of the server certificate and a line that says the certificate was verified as well as the actual response from the <code>helloworld</code> Pod:</p><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text>...
* Server certificate:
*  subject: CN=helloworld.mysuperdomain.com; O=hello world from mysuperdomain.com
*  start date: Feb 2 23:32:11 2021 GMT
*  expire date: Feb 2 23:32:11 2022 GMT
*  common name: helloworld.mysuperdomain.com (matched)
*  issuer: O=mysuperdomain.com Inc.; CN=mysuperdomain.com
<span style=display:block;width:100%;background-color:#19404a>*  SSL certificate verify ok.
</span>...
<span style=display:block;width:100%;background-color:#19404a>Hello World
</span></code></pre></div><h2 id=real-signed-certs-and-manual-setup>Real-signed certs and manual setup</h2><p>The self-signed cert route from the previous section is useful to kick the tires and test things out. We will need certificates signed by an actual certificate authority (CA) that your clients can trust.</p><p>There are a couple of ways you can get SSL certificates. The most popular one is <a href=https://letsencrypt.org/>Let&rsquo;s Encrypt</a>. We will be using <a href=https://www.sslforfree.com/>SSL For Free</a>, which uses Let&rsquo;s Encrypt to issue the certificates. If you want to spend money, you can also purchase SSL certificates from your domain registrar or at <a href=https://digicert.com>DigiCert</a>.</p><p>In this section, we will use a real domain name and actual SSL certificates - this means that if you want to follow along, make sure you have your domain ready to go.</p><p>Once you registered a domain, open <a href=https://sslforfree.com>SSL for Free</a> to get the SSL certificates. Note that you will have to register for a free account to create the SSL certificate.</p><ol><li>Enter your domain name, e.g. <code>mydomain.com</code> in the text field.</li><li>Click the Create Free SSL Certificate button.</li><li>From the dashboard, click the <strong>New Certificate</strong> button.</li></ol><p><img src=new-cert.png alt="New Certificate"></p><ol><li>Enter the domain name and click the <strong>Next Step</strong> button.</li><li>Select the 90-Day certificate option and click Next Step.</li><li>Confirm the auto-generate CSR option and click Next Step.</li><li>On the last page, select the <strong>Free</strong> option and click Next Step.</li></ol><p>Once the certificate is created, we will need to verify the domain name and prove we own the domain name we created the SSL certificate for.</p><p>There are three options to verify the domain: email verification (ensure you have emails set up on the domain), DNS (CNAME) verification, and HTTP file upload.</p><p><img src=install-cert.png alt="Install Certificate"></p><p>You can use any one of these options. I&rsquo;ll be using the CNAME verification. CNAME verification involves logging in to your domain registrars and setting a CNAME record with a specific value.</p><h3 id=set-the-a-name-record>Set the A name record</h3><p>While we are logged in to the domain registrar&rsquo;s website, let&rsquo;s also create an A record for the domain that will point to your cluster&rsquo;s external IP address.</p><p>Since we requested a certificate for mydomain.com and <a href=http://www.mydomain.com>www.mydomain.com</a>, the A record should point from <code>mydomain.com</code> to the IP address.</p><h3 id=verifying-the-domain>Verifying the domain</h3><p>After we&rsquo;ve set the A record and CNAME, we can click the <strong>Verify Domain</strong> button. Note that it might take a while for the values to propagate and verify the domain.</p><p>Once the domain is verified, the certificate will be issued, and you&rsquo;ll be able to download a ZIP package with generated files.</p><p>The package will contain the following files:</p><ul><li>ca_bundle.crt</li><li>certificate.crt</li><li>private.key</li></ul><h3 id=re-create-the-secret>Re-create the secret</h3><p>Let&rsquo;s delete the existing <code>ingressgateway-certs</code> secret, and create a new one with real certificates:</p><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>kubectl delete secret istio-ingressgateway-certs -n istio-system
</code></pre></div><p>We can re-create the Secret with the real SSL certificate and key we got from the downloaded package:</p><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>kubectl create secret tls istio-ingressgateway-certs -n istio-system --key private.key --cert certificate.crt
</code></pre></div><p>We also need to update the Gateway and the VirtualService to modify the hostnames.</p><p>Let&rsquo;s update the Gateway first (make sure you update the <code>mysuperdomain.com</code> to your actual domain name):</p><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>cat <span style=color:#2aa198>&lt;&lt;EOF | kubectl apply -f -
</span><span style=color:#2aa198>apiVersion: networking.istio.io/v1alpha3
</span><span style=color:#2aa198>kind: Gateway
</span><span style=color:#2aa198>metadata:
</span><span style=color:#2aa198>  name: public-gateway
</span><span style=color:#2aa198>spec:
</span><span style=color:#2aa198>  selector:
</span><span style=color:#2aa198>    istio: ingressgateway
</span><span style=color:#2aa198>  servers:
</span><span style=color:#2aa198>  - port:
</span><span style=color:#2aa198>      number: 443
</span><span style=color:#2aa198>      name: https
</span><span style=color:#2aa198>      protocol: HTTPS
</span><span style=color:#2aa198>    tls:
</span><span style=color:#2aa198>      mode: SIMPLE
</span><span style=color:#2aa198>      # These are coming from the istio-ingressgateway-certs secret
</span><span style=color:#2aa198>      serverCertificate: /etc/istio/ingressgateway-certs/tls.crt
</span><span style=color:#2aa198>      privateKey: /etc/istio/ingressgateway-certs/tls.key
</span><span style=color:#2aa198>    hosts:
</span><span style=color:#2aa198>    - mysuperdomain.com
</span><span style=color:#2aa198>EOF</span>
</code></pre></div><p>Similarly, make a change to the VirtualService:</p><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>cat <span style=color:#2aa198>&lt;&lt;EOF | kubectl apply -f -
</span><span style=color:#2aa198>apiVersion: networking.istio.io/v1alpha3
</span><span style=color:#2aa198>kind: VirtualService
</span><span style=color:#2aa198>metadata:
</span><span style=color:#2aa198>  name: helloworld
</span><span style=color:#2aa198>spec:
</span><span style=color:#2aa198>  hosts:
</span><span style=color:#2aa198>    - mysuperdomain.com
</span><span style=color:#2aa198>  gateways:
</span><span style=color:#2aa198>    - public-gateway
</span><span style=color:#2aa198>  http:
</span><span style=color:#2aa198>    - route:
</span><span style=color:#2aa198>      - destination:
</span><span style=color:#2aa198>          host: helloworld.default.svc.cluster.local
</span><span style=color:#2aa198>          port:
</span><span style=color:#2aa198>            number: 80
</span><span style=color:#2aa198>EOF</span>
</code></pre></div><p>With both of these resources updated, you can open your browser of choice and navigate to the domain. You should see <code>Hello World!</code> response and the padlock before the domain name shows that the website is secure. If you click on the padlock and check the certificate, you will see your domain name in the certificate, as well as the root authority (Let&rsquo;s Encrypt) and the expiration date.</p></div><nav class=pagination><a class="nav nav-prev" href=/istio-in-practice/sticky-sessions/><i class="ti-arrow-left mr-2"></i>
<span class="d-none d-md-block">How to use Sticky Sessions</span></a>
<a class="nav nav-next" href=/istio-in-practice/multiple-ingress-gateways/><span class="d-none d-md-block">How to Deploy Multiple Istio Ingress Gateways</span><i class="ti-arrow-right ml-2"></i></a></nav></div></div></div></div></section><footer><div class=container><div class="row align-items-center pb-0 footer-logo"><a class=navbar-brand href=/><img id=getistio-footer-logo class=img-fluid src=/images/tetrate-istio-distro-logo.png alt="Tetrate Istio Distro | Simple, safe enterprise-grade Istio"></a>
<a href=https://www.tetrate.io target=_blank><img id=tetrate-footer-logo class=img-fluid src=/images/tetrate-logo.svg alt="Tetrate Logo"></a></div><div class="py-4 text-center"><div class=mb-4><ul class="list-inline social-icons text-lg-center text-center"><li class=list-inline-item><a href=https://www.tetrate.io/ target=_blank aria-label="Tetrate website"><i class=ti-world></i></a></li><li class=list-inline-item><a href=https://www.twitter.com/tetrateio target=_blank aria-label="Tetrate Twitter account"><i class=ti-twitter-alt></i></a></li><li class=list-inline-item><a href=https://www.github.com/tetratelabs target=_blank aria-label="Tetrate Github account"><i class=ti-github></i></a></li><li class=list-inline-item><a href=https://www.linkedin.com/company/tetrate/ target=_blank aria-label="Tetrate LinkedIn account"><i class=ti-linkedin></i></a></li></ul></div><small class=text-white>Support: Join our <a href=https://tetr8.io/tetrate-community target=_blank>#tid-and-getmesh Slack Channel</a> for Community Support</small><br><small class=text-white>License: Tetrate Istio Distro is an open source project and is released under Apache License 2.0 | <a href=https://www.tetrate.io/privacy target=_blank>Privacy Statement</a></small><br><small class=text-white>Official project site of istio is <a href=https://www.istio.io target=_blank>istio.io</a></small><br><small class=text-white>Copyright &copy; 2023 <a href=https://www.tetrate.io target=_blank>Tetrate</a> All rights reserved.</small></div></div></footer><script type=text/javascript>var indexURL="/index.json",baseurl="https://istio.tetratelabs.io/"</script><script src=/plugins/jQuery/jquery.min.js></script><script src=/plugins/bootstrap/bootstrap.min.js></script><script src=/plugins/featherlight/featherlight.min.js></script><script src=/plugins/clipboard/clipboard.min.js></script><script src=/plugins/match-height/jquery.matchHeight-min.js></script><script src=/plugins/search/auto-complete.js></script><script src=/plugins/search/search.js></script><script src=/plugins/search/lunr.min.js></script><script src=/plugins/search/fuse.min.js></script><script src=/plugins/search/mark.js></script><script src=/plugins/search/search-page.js></script><script src=/js/script.min.js></script><script src=/js/form.min.js></script><script type=text/javascript src="//js.hsforms.net/forms/v2.js?pre=1"></script><script async defer src=https://buttons.github.io/buttons.js></script></body></html>