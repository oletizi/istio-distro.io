<!doctype html><html lang=en-us><head><meta charset=utf-8><title itemprop=name>How NetEase Qingzhou Enables Microservices Architecture Evolution with Istio | GetIstio by Tetrate | Simple, safe enterprise-grade Istio distro</title><meta name=twitter:title content="How NetEase Qingzhou Enables Microservices Architecture Evolution with Istio | GetIstio by Tetrate | Simple, safe enterprise-grade Istio distro"><meta itemprop=name content="How NetEase Qingzhou Enables Microservices Architecture Evolution with Istio | GetIstio by Tetrate | Simple, safe enterprise-grade Istio distro"><meta name=application-name content="How NetEase Qingzhou Enables Microservices Architecture Evolution with Istio | GetIstio by Tetrate | Simple, safe enterprise-grade Istio distro"><meta property="og:site_name" content="Tetrate Istio Distro"><meta name=description content="Tetrate Istio Distro project provides a simple, safe, enterprise-grade Istio distro."><meta itemprop=description content="Tetrate Istio Distro project provides a simple, safe, enterprise-grade Istio distro."><meta name=twitter:description content="Tetrate Istio Distro project provides a simple, safe, enterprise-grade Istio distro."><meta property="og:locale" content="en"><meta name=language content="En"><link rel=alternate hreflang=en href=/blog/netease-qingzhou-istio-practice/><link rel=alternate hreflang=zh href=/zh/blog/netease-qingzhou-istio-practice/><meta property="og:updated_time" content="2021-02-02T00:00:00Z"><link rel=sitemap type=application/xml title=Sitemap href=/sitemap.xml><meta property="og:type" content="article"><meta property="article:publisher" content><meta property="og:article:published_time" content="2021-02-02T00:00:00Z"><meta property="article:published_time" content="2021-02-02T00:00:00Z"><meta property="og:article:author" content="[ fei pei](https www.linkedin.com in 斐 裴 0a182099)"><meta property="article:author" content="[ fei pei](https www.linkedin.com in 斐 裴 0a182099)"><meta name=author content="[ fei pei](https www.linkedin.com in 斐 裴 0a182099)"><script defer type=application/ld+json>{"@context":"http://schema.org","@type":"Article","headline":"How NetEase Qingzhou Enables Microservices Architecture Evolution with Istio","author":{"@type":"Person","name":"https:\/\/github.com\/tetratelabs\/getmesh"},"datePublished":"2021-02-02","description":"The practice of using Istio in NetEase Qingzhou.","wordCount":1224,"mainEntityOfPage":"True","dateModified":"2021-02-02","image":{"@type":"imageObject","url":""},"publisher":{"@type":"Organization","name":"Tetrate Istio Distro | Simple, safe enterprise-grade Istio","logo":{"@type":"imageObject","url":"https://getistio.io/images/getistio-by-tetrate-logo.png"}}}</script><meta name=robots content="index,follow"><meta name=googlebot content="index,follow"><meta name=twitter:site content="@tetrateio"><meta name=twitter:creator content="@tetrateio"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=5"><meta name=generator content="Hugo 0.85.0"><script async src="https://www.googletagmanager.com/gtag/js?id=G-P3J9XNBME4"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-P3J9XNBME4')</script><link rel=preload href=/plugins/themify-icons/themify-icons.css as=style onload="this.onload=null,this.rel='stylesheet'"><noscript><link rel=stylesheet href=/plugins/themify-icons/themify-icons.css></noscript><link rel=preload href=/plugins/search/auto-complete.css as=style onload="this.onload=null,this.rel='stylesheet'"><noscript><link rel=stylesheet href=/plugins/search/auto-complete.css></noscript><link rel=preload href=/plugins/featherlight/featherlight.min.css as=style onload="this.onload=null,this.rel='stylesheet'"><noscript><link rel=stylesheet href=/plugins/featherlight/featherlight.min.css></noscript><link rel=preload href=/css/bootstrap/bootstrap.min.css as=style onload="this.onload=null,this.rel='stylesheet'"><noscript><link rel=stylesheet href=/css/bootstrap/bootstrap.min.css></noscript><link rel=preload href=/scss/style.css as=style onload="this.onload=null,this.rel='stylesheet'"><noscript><link rel=stylesheet href=/scss/style.css></noscript><link rel="shortcut icon" href=/images/getistio-favicon.png type=image/x-icon><link rel=icon href=/images/getistio-favicon.png type=image/x-icon><meta property="og:title" content="How NetEase Qingzhou Enables Microservices Architecture Evolution with Istio"><meta property="og:description" content="The practice of using Istio in NetEase Qingzhou."><meta property="og:type" content="article"><meta property="og:url" content="https://istio.tetratelabs.io/blog/netease-qingzhou-istio-practice/"><meta property="og:image" content="https://istio.tetratelabs.io/images/twitter-card-new.png"><meta property="article:section" content="blog"><meta property="article:published_time" content="2021-02-02T00:00:00+00:00"><meta property="article:modified_time" content="2021-02-02T00:00:00+00:00"><script async defer src=/js/turbolinks.min.js></script></head><body><header class="sticky-top navigation"><div class=my-container><nav class="navbar navbar-expand-lg navbar-light bg-transparent"><div class=navbar-brand-container><a class=navbar-brand href=/><img class="img-fluid logo-width" src=/images/tetrate-istio-distro-logo.png alt="Tetrate Istio Distro | Simple, safe enterprise-grade Istio"></a>
<a class=github-button href=https://github.com/tetratelabs/getistio data-icon=octicon-star aria-label="Star tetratelabs/getmesh on GitHub">Star</a></div><button aria-label=Menu class="navbar-toggler border-0" type=button data-toggle=collapse data-target=#navigation>
<i class="ti-menu h4 text-white"></i></button><div class="collapse navbar-collapse text-center" id=navigation><ul class="navbar-nav mx-auto align-items-center"><li class=nav-item><a class=nav-link href=/getmesh-cli/>Docs</a></li><li class=nav-item><a class=nav-link href=/blog/>Blog</a></li><li class=nav-item><a class=nav-link href=/community-events/>Community</a></li><li class=nav-item><a class=nav-link href=https://academy.tetrate.io target=_blank>Training</a></li><li class=nav-item><a class=nav-link href=https://func-e.io/ target=_blank>func-e</a></li><li class=nav-item><a class=nav-link href=https://www.istio.io/ target=_blank>Istio.io</a></li><li class=nav-link><select class=nav-item id=select-language onchange="location=this.value"><option id=en value=/blog/netease-qingzhou-istio-practice/ selected>En</option><option id=zh value=/zh/blog/netease-qingzhou-istio-practice/>中文</option></select></li></ul><div class="d-lg-none d-block"><a href=/download class="btn btn-sm btn-primary ml-lg-4">download</a></div></div><div class="d-lg-flex d-none"><a href=/download class="btn btn-sm btn-primary ml-lg-4">Download</a></div></nav></div></header><section class="py-5 blog-individual"><div class=container><div class="row mt-0 mb-0 justify-content-center"><div class=col-12><a href=../ class=link-grey>← Back to Blog</a><hr></div><div class="col-sm-9 mt-3"><h1>How NetEase Qingzhou Enables Microservices Architecture Evolution with Istio</h1><p class="blog-date mt-3"><span class=author-info>by <a href=https://www.linkedin.com/in/%E6%96%90-%E8%A3%B4-0a182099>Fei Pei</a></span>
<span>on Feb 2, 2021</span>
/ 6 min read</p><div class="article-tags mb-4"><span class="mr-3 single-tag"><a href=https://istio.tetratelabs.io/tags/case-study/>case study</a></span></div></div></div><div class="row justify-content-center mt-0 blog-content"><div class=col-sm-9><p>Author Fei Pei, he is a senior architect at NetEase Qingzhou.</p><p>In a company with diverse internet businesses like NetEase, each business has its own unique choice of microservices tech stack and system architecture based on their business nature and team composition. While this might seem harmless at the initial stage of business development, as the businesses grow, the business scale, level of complexity and team composition will vary. These problems may stand in the way of the microservices architecture:</p><ul><li>High R&D costs due to uncoordinated R&D efforts by different businesses.</li><li>Failure to make full use of the technological assets of the NetEase Group.</li><li>High level of intrusion into businesses. Business personnel must understand, learn about, monitor, and maintain the microservices framework</li><li>Long upgrade cycle. A minor framework upgrade may take more than a month.</li><li>Language limitations. The microservices system adopted by most core services is built from Java with little support for other languages.</li></ul><h2 id=strategies>Strategies</h2><p>The service mesh is a key microservices technology under the cloud-native system. It can effectively solve problems arising out of the microservices architecture adopted by a wide variety of internet businesses at NetEase. The decision by NetEase to use Istio, the classic service mesh open-source framework, is the product of careful deliberations:</p><ul><li>Strong background in cloud-native solutions. Endorsed by tech giants.</li><li>Envoy, a key data plane component of Istio, is a de facto standard component of the cloud-native data plane.</li><li>As the most popular choice within the service mesh landscape, Istio has a vibrant community and an outstanding architecture.</li><li>As an enterprise-friendly solution, Istio strives to optimize its services for improved user experience and enhanced support in service implementation.</li></ul><p>Having decided on Istio as the service mesh platform of choice, the NetEase Shufan Qingzhou team built the Qingzhou Service Mesh platform. This addresses the various problems of the microservices architecture faced by the diverse internet businesses of the NetEase Group and consolidates the existing microservices management framework. The establishment of this common, distributed microservices platform enables more enterprises to implement the evolution and upgrade of their microservices architecture. Further, NetEase Qingzhou has released an upgrade of the API gateway system built upon the Istio tech stack. The Envoy and Istio-based Qingzhou API gateway has enhanced capabilities and better performance. It has since become the standard component of the NetEase API gateway.
Despite the comprehensive service mesh solutions provided by Istio, enterprises still need to set clear goals when constructing their service mesh systems.</p><p><img src=008eGmZEly1gna7uuqkylj31cf0u0qv6.jpg alt="Goals when constructing service mesh system"></p><h3 id=architectural-design>Architectural Design</h3><p>An overview of the architecture of the NetEase Qingzhou Service Mesh is shown as follows:</p><p><img src=008eGmZEly1gna7su97x8j31340u0n2v.jpg alt="NetEase Service Mesh Architecuture"></p><h4 id=key-points-on-architectural-design>Key Points on Architectural Design:</h4><ul><li>The overall architectural design is implemented by <strong>extending Envoy and customizing Istio</strong>. The requisite feasibility checks have been carried out.</li><li><strong>Envoy-based data planes support various ways of interception</strong>. In addition to the complete interception of TCP traffic natively powered by Istio, other traffic interception methods that facilitate business integration, such as IP pointing and a dynamic interception, have been added.</li><li><strong>Components in the Istio Pilot-based control plane are pluggable</strong>. Before Istio 1.5, the control plane used to have more components, leading to higher maintenance costs. In designating Pilot as a key component of the control plane and making other components pluggable, the risks of production and implementation, as well as the maintenance costs, are significantly reduced. It also allows developers and maintainers to focus on building a better system.</li><li><strong>Multiple extension methods allowing easy integration with existing business platforms. Numerous open platforms</strong>, including the Istio CRD, MCP and API plane, can fully preserve their native capabilities. Simply with the use of a Restful API, they significantly reduce the costs incurred by businesses to build a new platform or to integrate with an existing platform.</li><li><strong>Performance improvements</strong>: Improvements are made on both components and networks. For components, as an example, the patterns of Envoy filter are now responsible for the back-end capabilities of the centralized mixer found in earlier versions of Istio, allowing configuration trimming for call tracing. On the other hand, the networks are faster than ever to keep up with the pace of container networks. This is a major step towards reducing latency.</li></ul><h3 id=development-plan>Development Plan</h3><p>The microservices architecture development plan is founded upon the overall architectural design and reference to the architecture and tech stack of services. Let’s take the NetEase e-commerce business as an example. Its business development plan is shown below:</p><p><img src=008eGmZEly1gna7t5zhrjj310n0u00y7.jpg alt="NetEase Service Mesh Evolution"></p><h4 id=key-points-on-development>Key Points on Development:</h4><ul><li>Overall migration architecture is specifically designed for the <strong>existing technologies and architectural pattern of the business</strong>.</li><li><strong>Business integration</strong>: Adaptation at the infrastructure level to ensure imperceptible migration for the business.</li><li><strong>Cross-cloud accesses</strong>: Ensuring seamless mutual accesses before and after migration with the use of the mixed cloud solutions of edge gateways.</li><li><strong>High usability</strong>: Ensuring that the SLAs are met during the migration process with added capabilities such as fallback routing as well as routing a certain percentage of traffic.</li></ul><h3 id=platform-building>Platform Building</h3><p>During their application of Istio, businesses need a visualized map of the mesh, and the ability to efficiently manage the mesh. Because of this, the NetEase Qingzhou microservices platform has been enhanced with the addition of service mesh monitoring capabilities and supporting cross-cluster centralized monitoring between service mesh and microservices framework (Spring Cloud, Dubbo, gRPC and Thrift). With this update, users can benefit from a smoother migration of their existing microservices architecture.</p><p><img src=008eGmZEly1gna7trfexbj31o20u00ye.jpg alt="NetEase Qingzhou Microservices Platform"></p><p><img src=008eGmZEly1gna7tx19ffj31o20u018n.jpg alt="NetEase Qingzhou Microservices Platform"></p><h4 id=key-points-on-building>Key Points on Building:</h4><p><strong>Stepping up on product enhancements to address business challenges</strong></p><ul><li><strong>Observability</strong>: Providing visualization tools and quick resolution functions.</li><li><strong>Usability</strong>: Packaging on par with cloud-native concept products.</li><li><strong>Extensibility</strong>: Open API system architecture. Rapid migration with business platforms.</li></ul><h3 id=system-building>System Building</h3><p>The Istio-based service mesh architecture requires comprehensive system protection features.</p><h4 id=key-points-on-system-building>Key Points on System Building</h4><ul><li><strong>Architectural and deployment</strong>: Service mesh component CICD and auto-deployments.</li><li><strong>Quality</strong>: Automated functions, performance, and stability testings; overall fault diagnosis; chaos testing.</li><li><strong>Debugging</strong>: Debugging for services and components; rapid fault location and recovery in the service mesh.</li><li><strong>Operations and maintenance</strong>: All-round monitoring and alarm functions.</li><li><strong>Hot upgrade</strong>: Support for hot upgrade of sidecars.</li><li><strong>Open-source technologies</strong>: The Qingzhou team continues to contribute to the service mesh community.</li></ul><h3 id=use-case-extensions-support-for-the-api-gateway>Use Case Extensions: Support for the API Gateway</h3><p><img src=008eGmZEly1gna7thob9yj30yr0u0n2f.jpg alt="NetEase Qingzhou API Gateway"></p><h4 id=key-points-on-design>Key Points on Design:</h4><ul><li>Extensions of the service mesh tech stack, making full use of cloud-native technologies.</li><li>Overall design validation and feasibility checks.</li><li>Enhancement on the extensibility of the high-performance control plane Envoy.</li><li>Multiple extension plug-in methods for the primary control plane Istio Pilot.</li><li>API interface design mitigates the discrepancies between different platforms, fostering rapid integration across platforms.</li></ul><h2 id=results>Results</h2><ul><li>Various services of NetEase, including NetEase Yeation, NetEase Media, NetEase Youdao, and industry platforms, have been successfully launched. <strong>NetEase effectively manages thousands of services and tens of thousands of instances.</strong></li><li>The NetEase microservices architecture is built onto a uniform infrastructure. Different lines of business can now leave the hassles of microservices management behind as well as lower R&D and maintenance costs for microservices.</li><li>Introduction of service management capabilities, such as multi-language management, hot upgrade, fault injection, routing, and fuse downgrade.</li><li>As part of the long-term plan for cloud-native infrastructure, more use cases are now supported: API gateways, DB & middleware mesh, failure drill, and so on. API gateway has become the standard component of the NetEase API gateway, providing <strong>support for entire site traffic access for many core services of NetEase, such as NetEaseMedia, NetEase Yeation, and NetEase Lofter</strong>.</li><li>The NetEase microservices architecture and technologies are leading in the industry.</li></ul></div></div><div class="col-12 blog-post-footer"><hr><a href=/blog/ class=link-grey>← Back to Blog</a></div></div></section><footer><div class=container><div class="row align-items-center pb-0 footer-logo"><a class=navbar-brand href=/><img id=getistio-footer-logo class=img-fluid src=/images/tetrate-istio-distro-logo.png alt="Tetrate Istio Distro | Simple, safe enterprise-grade Istio"></a>
<a href=https://www.tetrate.io target=_blank><img id=tetrate-footer-logo class=img-fluid src=/images/tetrate-logo.svg alt="Tetrate Logo"></a></div><div class="py-4 text-center"><div class=mb-4><ul class="list-inline social-icons text-lg-center text-center"><li class=list-inline-item><a href=https://www.tetrate.io/ target=_blank aria-label="Tetrate website"><i class=ti-world></i></a></li><li class=list-inline-item><a href=https://www.twitter.com/tetrateio target=_blank aria-label="Tetrate Twitter account"><i class=ti-twitter-alt></i></a></li><li class=list-inline-item><a href=https://www.github.com/tetratelabs target=_blank aria-label="Tetrate Github account"><i class=ti-github></i></a></li><li class=list-inline-item><a href=https://www.linkedin.com/company/tetrate/ target=_blank aria-label="Tetrate LinkedIn account"><i class=ti-linkedin></i></a></li></ul></div><small class=text-white>Support: Join our <a href=https://tetr8.io/tetrate-community target=_blank>#tid-and-getmesh Slack Channel</a> for Community Support</small><br><small class=text-white>License: Tetrate Istio Distro is an open source project and is released under Apache License 2.0 | <a href=https://www.tetrate.io/privacy target=_blank>Privacy Statement</a></small><br><small class=text-white>Official project site of istio is <a href=https://www.istio.io target=_blank>istio.io</a></small><br><small class=text-white>Copyright &copy; 2023 <a href=https://www.tetrate.io target=_blank>Tetrate</a> All rights reserved.</small></div></div></footer><script type=text/javascript>var indexURL="/index.json",baseurl="https://istio.tetratelabs.io/"</script><script src=/plugins/jQuery/jquery.min.js></script><script src=/plugins/bootstrap/bootstrap.min.js></script><script src=/plugins/featherlight/featherlight.min.js></script><script src=/plugins/clipboard/clipboard.min.js></script><script src=/plugins/match-height/jquery.matchHeight-min.js></script><script src=/plugins/search/auto-complete.js></script><script src=/plugins/search/search.js></script><script src=/plugins/search/lunr.min.js></script><script src=/plugins/search/fuse.min.js></script><script src=/plugins/search/mark.js></script><script src=/plugins/search/search-page.js></script><script src=/js/script.min.js></script><script src=/js/form.min.js></script><script type=text/javascript src="//js.hsforms.net/forms/v2.js?pre=1"></script><script async defer src=https://buttons.github.io/buttons.js></script></body></html>